# 키움 API 연동 설정 가이드

## 개요

이 가이드는 실제 키움 Open API+를 사용하여 트레이딩 시스템과 연동하는 방법을 설명합니다.

## 1단계: 키움 증권 계정 설정

### 1.1 키움 증권 계정 생성
1. **키움 증권 웹사이트 방문**: https://www.kiwoom.com
2. **회원가입**: 실명 인증 및 계정 생성
3. **계좌 개설**: 주식 거래 계좌 개설

### 1.2 모의투자 신청
1. **모의투자 신청**: 키움 증권에서 모의투자 신청
2. **승인 대기**: 1-2일 내 승인 완료
3. **모의투자 계좌**: 별도 모의투자 계좌번호 발급

## 2단계: 영웅문 설치 및 설정

### 2.1 영웅문 다운로드
1. **영웅문 다운로드**: 키움 증권에서 영웅문 다운로드
2. **설치**: 32비트 환경에서 설치 권장
3. **로그인**: 계정 정보로 로그인

### 2.2 기본 설정
1. **환경설정**: 영웅문 환경설정에서 기본 설정
2. **보안 설정**: 공인인증서 등록
3. **계좌 연결**: 실제/모의투자 계좌 연결

## 3단계: Open API+ 신청

### 3.1 API 신청
1. **영웅문 실행**: 영웅문에서 Open API+ 신청
2. **신청서 작성**: API 사용 목적 및 계획 작성
3. **승인 대기**: 1-3일 내 승인 완료

### 3.2 API 키 발급
1. **승인 완료**: 키움에서 API 승인 완료 통보
2. **API 키 확인**: 영웅문에서 API 키 확인
3. **테스트**: API 연결 테스트

## 4단계: 설정 파일 구성

### 4.1 config/kiwoom_config.json 수정
```json
{
  "api_key": "실제_API_키_입력",
  "user_id": "실제_사용자_ID",
  "password": "실제_비밀번호",
  "cert_password": "공인인증서_비밀번호",
  "account_number": "실제_계좌번호",
  "server_type": "모의투자",
  "auto_login": true,
  "real_trading": false,
  "log_level": "INFO",
  "connection_timeout": 30,
  "retry_count": 3
}
```

### 4.2 설정 항목 설명
- **api_key**: 키움에서 발급받은 API 키
- **user_id**: 키움 증권 로그인 ID
- **password**: 키움 증권 로그인 비밀번호
- **cert_password**: 공인인증서 비밀번호
- **account_number**: 실제 거래 계좌번호
- **server_type**: "모의투자" 또는 "실거래"
- **real_trading**: 실거래 여부 (false 권장)

## 5단계: 실제 키움 API 연동

### 5.1 실제 키움 API 브리지 실행
```bash
# 32비트 Python 환경에서
python real_kiwoom_bridge.py
```

### 5.2 연결 테스트
```bash
# 헬스 체크
curl http://localhost:8001/health

# 키움 API 연결
curl -X POST http://localhost:8001/api/v1/connect

# 계좌 정보 조회
curl http://localhost:8001/api/v1/account
```

## 6단계: 보안 고려사항

### 6.1 API 키 보안
- **환경 변수 사용**: 민감 정보는 환경 변수로 관리
- **파일 권한**: 설정 파일 접근 권한 제한
- **정기적 갱신**: API 키 정기적 갱신

### 6.2 네트워크 보안
- **방화벽 설정**: 필요한 포트만 개방
- **IP 제한**: 허용된 IP에서만 접근
- **HTTPS 사용**: 프로덕션 환경에서는 HTTPS 필수

## 7단계: 모의투자 테스트

### 7.1 모의투자 환경
1. **모의투자 계좌**: 실제 자금 없이 테스트 가능
2. **실시간 데이터**: 실제 시장 데이터 사용
3. **주문 실행**: 실제 주문과 동일한 프로세스

### 7.2 테스트 시나리오
1. **계좌 정보 조회**: 잔고, 보유 종목 확인
2. **시장 데이터 조회**: 실시간 가격 정보 확인
3. **주문 실행**: 매수/매도 주문 테스트
4. **주문 내역 조회**: 주문 상태 및 체결 확인

## 8단계: 실거래 전환

### 8.1 실거래 준비
1. **충분한 테스트**: 모의투자에서 충분한 테스트 완료
2. **리스크 관리**: 손실 한도 및 리스크 관리 정책 수립
3. **모니터링**: 실시간 모니터링 시스템 구축

### 8.2 설정 변경
```json
{
  "server_type": "실거래",
  "real_trading": true
}
```

## 9단계: 문제 해결

### 9.1 일반적인 문제
1. **연결 실패**: API 키 및 계정 정보 확인
2. **인증 오류**: 공인인증서 및 비밀번호 확인
3. **주문 실패**: 계좌 잔고 및 주문 조건 확인

### 9.2 로그 확인
```bash
# 브리지 서버 로그 확인
tail -f logs/real_kiwoom_bridge.log

# 시스템 로그 확인
tail -f logs/integrated_system.log
```

## 10단계: 성능 최적화

### 10.1 연결 최적화
- **연결 풀링**: API 연결 재사용
- **타임아웃 설정**: 적절한 타임아웃 값 설정
- **재시도 로직**: 연결 실패 시 자동 재시도

### 10.2 데이터 최적화
- **캐싱**: 자주 사용하는 데이터 캐싱
- **배치 처리**: 여러 주문을 배치로 처리
- **비동기 처리**: 비동기 방식으로 데이터 처리

## 주의사항

### ⚠️ 중요 고지사항
1. **실거래 위험**: 실제 자금이 사용되므로 신중하게 접근
2. **API 제한**: 키움 API 사용량 및 속도 제한 확인
3. **법적 규정**: 자동매매 관련 법적 규정 준수
4. **시스템 안정성**: 24시간 운영을 위한 시스템 안정성 확보

### 📞 지원 연락처
- **키움 증권 고객센터**: 1544-9000
- **Open API+ 지원**: 키움 증권 API 지원팀
- **기술 문서**: 키움 증권 개발자 센터

## 다음 단계

키움 API 연동이 완료되면 다음 단계로 진행할 수 있습니다:

1. **딥러닝 모델 고도화**: TensorFlow 기반 고급 모델 구축
2. **클라우드 배포**: AWS/GCP 클라우드 환경 배포
3. **고급 분석**: 감정분석, 포트폴리오 최적화
4. **모니터링 시스템**: 실시간 모니터링 및 알림 시스템 